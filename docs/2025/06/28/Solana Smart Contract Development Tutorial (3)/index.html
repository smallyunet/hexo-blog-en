<!DOCTYPE html><html lang="en"><head><title>Solana Smart Contract Development Tutorial (3)</title><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=0.5"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="stylesheet" href="/css/highlight/xcode.min.css"><link rel="stylesheet" href="/css/bootstrap/bootstrap-tooltips.css"><link rel="stylesheet" href="/css/post.css"><script src="/js/jquery.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="smallyu‘s Blog" type="application/atom+xml">
</head><body><script>if (/mobile/i.test(navigator.userAgent) || /android/i.test(navigator.userAgent)) {
  document.body.classList.add('mobile')
  var navbar = document.querySelector('nav.navbar');
  if (navbar) {
    navbar.classList.remove('navbar-fixed-top');
  }
}
</script><div><div class="inner"><h1>Solana Smart Contract Development Tutorial (3)</h1><div class="time">2025-06-28</div><div class="title-margin"></div><blockquote>
<p>This is a beginner-friendly tutorial series that teaches Solana smart contract development from the very basics.</p>
<ul>
<li><a href="/2025/06/24/Solana%20Smart%20Contract%20Development%20Tutorial%20(1)/">Part 1</a>: Basic environment setup, deploying HelloWorld contract, on-chain contract interaction</li>
<li><a href="/2025/06/26/Solana%20Smart%20Contract%20Development%20Tutorial%20(2)/">Part 2</a>: Creating a minimal USDT contract model, custom data structures and methods</li>
<li><a href="/2025/06/28/Solana%20Smart%20Contract%20Development%20Tutorial%20(3)/">Part 3</a>: Using the official SPL library to reuse contract functionality and issue a standard token</li>
</ul>
</blockquote>
<p>You may notice that writing smart contract logic is relatively lightweight. The complexity lies mostly in different <code>#[account]</code> macro usages and understanding parameters like whether accounts can be auto-created, how many bytes to reserve, etc. Because all account data must be loaded into Solana validator memory—which is costly—developers need to be precise with space usage. Solana’s account model also requires some understanding.</p>
<h3 id="1-Issue-Tokens-via-CLI"><a href="#1-Issue-Tokens-via-CLI" class="headerlink" title="1. Issue Tokens via CLI"></a>1. Issue Tokens via CLI</h3><p>For standard tokens like USDT, Solana provides built-in libraries and command-line tools—no need to write contracts. These are called SPL Tokens. To create a token with 6 decimal places:</p>
<pre><code class="bash">spl-token create-token --decimals 6
</code></pre>
<p>After executing, you’ll see an <code>Address</code>, which is your token’s address, e.g., <code>E75GMXAfJ91XuRboSpjwkDmta45Etgt3F3Gf5WLZvLbV</code>. You can look it up in the <a href="https://explorer.solana.com/address/E75GMXAfJ91XuRboSpjwkDmta45Etgt3F3Gf5WLZvLbV?cluster=devnet">block explorer</a>.</p>
<p>Next, create an Associated Token Account (ATA) for your wallet:</p>
<pre><code class="bash">spl-token create-account E75GMXAfJ91XuRboSpjwkDmta45Etgt3F3Gf5WLZvLbV
</code></pre>
<p>This creates a record in the token contract’s internal map. Without it, your address can’t hold USDT. To view your ATA:</p>
<pre><code class="bash">spl-token address --verbose --token E75GMXAfJ91XuRboSpjwkDmta45Etgt3F3Gf5WLZvLbV
</code></pre>
<p>Example output:</p>
<pre><code>Wallet address: 75sFifxBt7zw1YrDfCdPjDCGDyKEqLWrBarPCLg6PHwb  
Associated token address: E5XmcEJhhGUri8itThLGk8QfPzY1acFid8JmVyo5DWUo
</code></pre>
<p>Check token balance:</p>
<pre><code class="bash">spl-token balance E75GMXAfJ91XuRboSpjwkDmta45Etgt3F3Gf5WLZvLbV 
</code></pre>
<p>To mint tokens:</p>
<pre><code class="bash">spl-token mint E75GMXAfJ91XuRboSpjwkDmta45Etgt3F3Gf5WLZvLbV 5 E5XmcEJhhGUri8itThLGk8QfPzY1acFid8JmVyo5DWUo
</code></pre>
<p>To transfer tokens:</p>
<pre><code class="bash">spl-token transfer &lt;MINT&gt; 1 &lt;ATA&gt;
# or
spl-token transfer &lt;MINT&gt; 1 &lt;RECIPIENT_WALLET&gt;
</code></pre>
<h3 id="2-Writing-Contracts-with-SPL-Standard-Libraries"><a href="#2-Writing-Contracts-with-SPL-Standard-Libraries" class="headerlink" title="2. Writing Contracts with SPL Standard Libraries"></a>2. Writing Contracts with SPL Standard Libraries</h3><p>Let’s create a project that uses the official <code>anchor-spl</code> crate for minting:</p>
<pre><code class="bash">anchor init usdt_spl
cargo add anchor-spl
</code></pre>
<p>Add SPL imports in your contract:</p>
<pre><code class="rust">use anchor_spl::token::&#123;self, MintTo, Token, TokenAccount, Mint&#125;;
</code></pre>
<p>Define the mint context:</p>
<pre><code class="rust">#[derive(Accounts)]
pub struct MintToCtx&lt;&#39;info&gt; &#123;
    #[account(mut)]
    pub mint: Account&lt;&#39;info, Mint&gt;, 

    #[account(mut)]
    pub to:   Account&lt;&#39;info, TokenAccount&gt;,

    #[account(mut)]
    pub authority: Signer&lt;&#39;info&gt;,

    pub token_program: Program&lt;&#39;info, Token&gt;,
&#125;
</code></pre>
<p>Implement conversion to CPI context:</p>
<pre><code class="rust">impl&lt;&#39;info&gt; From&lt;&amp;MintToCtx&lt;&#39;info&gt;&gt; for CpiContext&lt;&#39;_, &#39;_, &#39;_, &#39;info, MintTo&lt;&#39;info&gt;&gt;
&#123;
    fn from(accts: &amp;MintToCtx&lt;&#39;info&gt;) -&gt; Self &#123;
        let cpi_accounts = MintTo &#123;
            mint:      accts.mint.to_account_info(),
            to:        accts.to.to_account_info(),
            authority: accts.authority.to_account_info(),
        &#125;;
        CpiContext::new(accts.token_program.to_account_info(), cpi_accounts)
    &#125;
&#125;
</code></pre>
<p>Add program logic:</p>
<pre><code class="rust">pub fn mint_to(ctx: Context&lt;MintToCtx&gt;, amount: u64) -&gt; Result&lt;()&gt; &#123;
    token::mint_to((&amp;*ctx.accounts).into(), amount)
&#125;
</code></pre>
<p>Update <code>Cargo.toml</code> features:</p>
<pre><code class="toml">[features]
idl-build = [&quot;anchor-lang/idl-build&quot;, &quot;anchor-spl/idl-build&quot;]

[dependencies]
anchor-spl = &#123; version = &quot;0.31.1&quot;, features = [&quot;token&quot;, &quot;idl-build&quot;] &#125;
</code></pre>
<p>Compile:</p>
<pre><code class="bash">anchor build
</code></pre>
<h3 id="3-Unit-Testing"><a href="#3-Unit-Testing" class="headerlink" title="3. Unit Testing"></a>3. Unit Testing</h3><p>Install required dependencies:</p>
<pre><code class="bash">npm i @coral-xyz/anchor@^0.31 @solana/spl-token chai
</code></pre>
<p>Test file <code>tests/usdt_spl.ts</code>:</p>
<pre><code class="ts">import anchor from &quot;@coral-xyz/anchor&quot;;
import &#123; Program &#125; from &quot;@coral-xyz/anchor&quot;;
import &#123;
  createMint,
  createAssociatedTokenAccount,
  getAccount,
  TOKEN_PROGRAM_ID,
&#125; from &quot;@solana/spl-token&quot;;
import &#123; assert &#125; from &quot;chai&quot;;

const &#123; AnchorProvider, BN &#125; = anchor;

describe(&quot;usdt_spl / mint_to&quot;, () =&gt; &#123;
  const provider = AnchorProvider.env();
  anchor.setProvider(provider);
  const program = anchor.workspace.UsdtSpl as Program;

  let mintPubkey: anchor.web3.PublicKey;
  let ata: anchor.web3.PublicKey;

  it(&quot;creates mint, mints 1 USDT into ATA&quot;, async () =&gt; &#123;
    mintPubkey = await createMint(
      provider.connection,
      provider.wallet.payer,
      provider.wallet.publicKey,
      null,
      6
    );

    ata = await createAssociatedTokenAccount(
      provider.connection,
      provider.wallet.payer,
      mintPubkey,
      provider.wallet.publicKey
    );

    await program.methods
      .mintTo(new BN(1_000_000))
      .accounts(&#123;
        mint: mintPubkey,
        to: ata,
        authority: provider.wallet.publicKey,
        tokenProgram: TOKEN_PROGRAM_ID,
      &#125;)
      .rpc();

    const accInfo = await getAccount(provider.connection, ata);
    assert.equal(accInfo.amount.toString(), &quot;1000000&quot;);
  &#125;);
&#125;);
</code></pre>
<p>Run the tests:</p>
<pre><code class="bash">anchor test
</code></pre>
<h3 id="4-Deploy-to-Devnet"><a href="#4-Deploy-to-Devnet" class="headerlink" title="4. Deploy to Devnet"></a>4. Deploy to Devnet</h3><p>Deploy using anchor:</p>
<pre><code class="bash">anchor deploy --provider.cluster devnet
</code></pre>
<p>If network issues occur, try:</p>
<pre><code class="bash">anchor deploy --provider.cluster &quot;&lt;your-rpc-url&gt;&quot;
# Or
solana program deploy \
  target/deploy/usdt_spl.so \
  --program-id target/deploy/usdt_spl-keypair.json \
  --url &quot;&lt;your-rpc-url&gt;&quot;
</code></pre>
<h3 id="5-Use-SDK-to-Interact-with-Deployed-Contract"><a href="#5-Use-SDK-to-Interact-with-Deployed-Contract" class="headerlink" title="5. Use SDK to Interact with Deployed Contract"></a>5. Use SDK to Interact with Deployed Contract</h3><p>File: <code>app/app.js</code>:</p>
<pre><code class="js">const anchor = require(&quot;@coral-xyz/anchor&quot;);
const &#123;
  createMint,
  createAssociatedTokenAccount,
  getAccount,
  TOKEN_PROGRAM_ID,
&#125; = require(&quot;@solana/spl-token&quot;);
const fs   = require(&quot;fs&quot;);
const os   = require(&quot;os&quot;);
const path = require(&quot;path&quot;);
const &#123; Keypair, Connection &#125; = anchor.web3;

const RPC_URL = process.env.RPC_URL || &quot;https://api.devnet.solana.com&quot;;
const connection = new Connection(RPC_URL, &#123; commitment: &quot;confirmed&quot; &#125;);

const secret = Uint8Array.from(
  JSON.parse(fs.readFileSync(path.join(os.homedir(), &quot;.config/solana/id.json&quot;)))
);
const wallet = new anchor.Wallet(Keypair.fromSecretKey(secret));
const provider = new anchor.AnchorProvider(connection, wallet, &#123;
  preflightCommitment: &#39;confirmed&#39;,
&#125;);
anchor.setProvider(provider);

const idl  = JSON.parse(fs.readFileSync(path.resolve(&quot;target/idl/usdt_spl.json&quot;)));
const prog = new anchor.Program(idl, provider);

(async () =&gt; &#123;
  const mint = await createMint(connection, wallet.payer, wallet.publicKey, null, 6);
  const ata  = await createAssociatedTokenAccount(connection, wallet.payer, mint, wallet.publicKey);

  const sig = await prog.methods
    .mintTo(new anchor.BN(1_000_000))
    .accounts(&#123; mint, to: ata, authority: wallet.publicKey, tokenProgram: TOKEN_PROGRAM_ID &#125;)
    .rpc();

  console.log(&quot;tx:&quot;, sig);
  console.log(`explorer: https://explorer.solana.com/tx/$&#123;sig&#125;?cluster=devnet`);

  const bal = await getAccount(connection, ata);
  console.log(&quot;balance:&quot;, bal.amount.toString());
&#125;)();
</code></pre>
<p>Expected output:</p>
<pre><code>tx: 3MgHxsfnJp68mrrABvCh9iwNm6MSXp1SEvk7vDYHoW7KhTEHfVNyMWsbfbEAXTC9gLzcmWu5xbkzia8hgZrcZ18i
explorer: https://explorer.solana.com/tx/3MgHxsfnJp68mrrABvCh9iwNm6MSXp1SEvk7vDYHoW7KhTEHfVNyMWsbfbEAXTC9gLzcmWu5xbkzia8hgZrcZ18i?cluster=devnet
balance: 1000000
</code></pre>
</div></div></body><script src="/js/highlight.min.js"></script><script src="/js/main.js"></script><script src="/js/bootstrap/bootstrap.min.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-2615E2THFJ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-2615E2THFJ');</script></html>