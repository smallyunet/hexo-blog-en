<!-- Stable asset version (for cache busting without full-site churn)--><!DOCTYPE html><html lang="en"><head><title>Guess 2/3 of the Average dApp Game Design</title><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- SEO basics--><meta name="description"><!-- Open Graph & Twitter--><link rel="canonical" href="https://en.smallyu.net/2022/12/27/Designing a Guess 2_3 of the Average dApp Game/"><meta property="og:title" content="Guess 2/3 of the Average dApp Game Design"><meta property="og:type" content="article"><meta property="og:url" content="https://en.smallyu.net/2022/12/27/Designing a Guess 2_3 of the Average dApp Game/"><meta property="og:site_name" content="smallyu‘s Blog"><meta name="twitter:card" content="summary_large_image"><!-- Browser UI color--><meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0f1115"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><!-- stylesheets--><!-- Use a stable, configurable asset version to prevent full-site churn on every build.--><!-- Set `asset_version` in theme _config.yml when you actually change CSS/JS.--><link rel="stylesheet" href="/css/xcode.min.css?v=2025-09-28.27"><link rel="stylesheet" href="/css/post.css?v=2025-09-28.27"><!-- unified typography overrides for both home and post pages--><link rel="stylesheet" href="/css/typography.css?v=2025-09-28.27"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="smallyu‘s Blog" type="application/atom+xml">
</head><body><div><div class="inner"><h1>Guess 2/3 of the Average dApp Game Design</h1><div class="time">2022-12-27</div><div class="title-margin"></div><p><a href="https://zh.m.wikipedia.org/zh-cn/%E7%8C%9C%E5%9D%87%E5%80%BC%E7%9A%842/3">Guess 2&#x2F;3 of the Average</a> is a classic game-theory exercise. This post adapts it into a blockchain-based dApp. The basic rules are:</p>
<ol>
<li>A player pays <strong>any amount</strong> to join a round.  </li>
<li>Sum the <strong>total amount</strong> paid by all players.  </li>
<li>Take two-thirds of the <strong>average</strong> of this total as the <strong>winning number</strong>.  </li>
<li>The player whose <strong>paid amount</strong> is closest to the winning number wins.</li>
</ol>
<p>Reward rules:</p>
<ol start="5">
<li>The winner receives the round’s <strong>total amount</strong>.  </li>
<li>The contract collects a 1 % <strong>service fee</strong> from the total each round.</li>
</ol>
<p>A key question is how many players are in a round—i.e., when does a round end? The ending rule is:</p>
<ol start="7">
<li>When a player joins, they learn they are the <strong>n-th</strong> participant.  </li>
<li>Generate a random number <strong>x</strong> (10 ≤ x ≤ 100).  </li>
<li>Define a random boundary <strong>l, r &#x3D; n − x, n + x</strong>.  </li>
<li>Draw another random number <strong>y</strong> within <strong>[l, r]</strong>.  </li>
<li>If <strong>y &#x3D;&#x3D; n</strong>, the round ends.</li>
</ol>
<p>Additional rules:</p>
<ol start="12">
<li>If a user joins multiple times, only their <strong>first</strong> entry counts.  </li>
<li>If several users pay <strong>identical amounts</strong>, the one who joined <strong>first</strong> wins.</li>
</ol>
<p>Those are all the rules.</p>
<p>The ending rule is a bit involved, so here’s an example. Suppose a player is the <strong>n &#x3D; 50</strong>-th entrant and <strong>x &#x3D; 10</strong>. The boundary becomes <strong>l, r &#x3D; 45, 55</strong>. A new random number is picked in [45, 55]; if it happens to be 50, the round ends.</p>
<p><strong>Why do this?</strong> Because blockchain data are public. In the original game, every choice is hidden, which is hard to replicate on-chain. The dApp version therefore differs in two main ways:</p>
<ul>
<li>A player may pay <strong>any</strong> amount—even 0 or extremely large—whereas the original game had an upper cap.  </li>
<li>The number of players is <strong>unknown</strong>, while the original fixed it.</li>
</ul>
<p>Both changes stem from on-chain transparency, so randomness must be added. Without a random ending, later players would always have an advantage by seeing earlier entries.</p>
<p>Of course, the last player cannot always overturn the result, especially with an upper cap, but if the player count is random there is no guaranteed “last” player—no one knows when the round will stop. Even someone rich enough to swing the average could be overtaken instantly.</p>
<p>The original game required integer inputs; the dApp version lifts that restriction because a smart contract can handle arbitrary precision.</p>
<hr>
<h3 id="Why-the-ending-rule-works"><a href="#Why-the-ending-rule-works" class="headerlink" title="Why the ending rule works"></a>Why the ending rule works</h3><p>Its effect is to make a round end, in most cases, when the player count falls in **[10, 100]**—the range set by <strong>x</strong> in rule 9.</p>
<p>Think of it this way: every user has a random <strong>chance</strong> to end the round, between 1⁄10 and 1⁄100. If the chance were 1⁄10, a round would typically end after about 10 players; if 1⁄100, after about 100 players. Thus <strong>x</strong> roughly limits the player count. (The [10, 100] range is approximate, not an exact calculation.)</p>
<p>Using this rule, I simulated 100 000 rounds and recorded the player count at which each ended. Code: <a href="https://github.com/guessavg/emulate_tool">guessavg&#x2F;emulate_tool</a></p>
<img src="chart1.png" width="60%">

<p>The horizontal axis is player count; the vertical axis is how many times a round ended at that count. Near 1, there are 2 500 occurrences—i.e., 2.5 % of rounds ended after a single player.</p>
<img src="chart2.png" width="60%">

<p>If raw counts feel abstract, see the ratio chart: no single count exceeds 2.5 %. Early positions have higher odds because every round starts from zero.</p>
<img src="chart3.png" width="60%">

<p>This ratio view is clearer: about 20 % of rounds end with fewer than 10 players, ~70 % within <strong>[10, 100]</strong>, and only 0.07 % need more than 300 players.</p>
<p>Although the distribution is not perfectly normal, it meets the goal: rounds finish at random yet reasonable times, avoiding too-few or too-many participants while still allowing a small chance (up to ~500 players).</p>
<p>I believe this is a sound design.</p>
<p><br/><br/></p>
<h3 id="Update-2025-04-22"><a href="#Update-2025-04-22" class="headerlink" title="Update (2025-04-22)"></a>Update (2025-04-22)</h3><p>Over a year ago I wrote “<a href="/2022/12/27/%E2%80%9C%E7%8C%9C%E5%9D%87%E5%80%BC%E7%9A%842-3%E2%80%9DdApp-%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/">‘Guess 2&#x2F;3 of the Average’ dApp Game Design</a>”.</p>
<p>Thanks to modern ChatGPT, implementing the game is now easy; contract and front-end are quick to build. I spent only two hours today to create a demo page.</p>
<p>Play here: <a href="https://guessavg.oiia.network/">https://guessavg.oiia.network/</a></p>
<p>Some notes:</p>
<ol>
<li>The mini-game currently runs on Oiia Network. Contract address <a href="https://explorer.oiia.network/account/0x6eb079C9D3005Bd596E8a0E5065fA33C80aBA8F1"><code>0x6eb07...BA8F1</code></a>  </li>
<li>Joining simply calls a contract function and transfers funds—for example, tx <a href="https://explorer.oiia.network/tx/0x1bfb286c9ed796e16870cc36488bd3c11db6eef43e34c425e58ac76715010936"><code>0x1bfb2...10936</code></a>  </li>
<li>Contract code: <a href="https://github.com/guessavg/contract">guessavg&#x2F;contract</a>. It can be deployed anywhere; I used Oiia because it’s free.  </li>
<li>Front-end code: <a href="https://github.com/guessavg/game">guessavg&#x2F;game</a>, used with the contract.  </li>
<li>Get test OIIA from the faucet: <a href="https://faucet.oiia.network/">https://faucet.oiia.network/</a>  </li>
<li>The private key below holds 10 OIIA for testing. Duplicate entries from the same address are disallowed, so transfer OIIA to a fresh address first:<br><code>fdf0aec857f3ac4fe146e0d00fb3a7a729646a081719df3f4e168a541a21893b</code>  </li>
<li>Metamask shows an error when adding Oiia, but it actually succeeds; I haven’t debugged it. A month ago this code raised no error.  </li>
<li>Oiia Network may disappear at any time.  </li>
<li>Just for fun…</li>
</ol>
<br>

<h3 id="Update-2025-05-06"><a href="#Update-2025-05-06" class="headerlink" title="Update (2025-05-06)"></a>Update (2025-05-06)</h3><p>Oiia Network shut down today because I no longer wish to fund an unused chain. The demo has moved to Base.</p>
<ol>
<li>Demo: <a href="https://guessavg.github.io/game/">https://guessavg.github.io/game/</a>  </li>
<li>Contract on Base: <a href="https://basescan.org/address/0x4BbeE9F876ff56832E724DC9a7bD06538C8868D2"><code>0x4BbeE...868D2</code></a>  </li>
<li>You need ETH on Base to play.  </li>
<li>The game is easier now; a round ends after only two or three players.</li>
</ol>
</div></div></body><!-- Defer non-critical scripts for better performance--><script defer src="/js/jquery.min.js?v=2025-09-28.27"></script><script defer src="/js/highlight.min.js?v=2025-09-28.27"></script><script defer src="/js/main.js?v=2025-09-28.27"></script><script defer src="/js/lightbox.js?v=2025-09-28.27"></script><script defer src="/js/bootstrap.min.js?v=2025-09-28.27"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5JRBZ6P1W3"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5JRBZ6P1W3');</script></html>